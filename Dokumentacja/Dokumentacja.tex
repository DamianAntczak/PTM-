\documentclass[a4paper,10pt,oneside]{book}
\usepackage{standalone}
\usepackage{suffix}
\usepackage{ifthen}
\usepackage{anysize}
\setlength{\columnsep}{5mm}
\marginsize{2.3cm}{2.3cm}{2cm}{1.7cm}
\usepackage[polish]{babel}
\usepackage[cp1250]{inputenc}
\usepackage{polski}
\usepackage{listings}
\usepackage{graphicx}
\usepackage{color}
\usepackage{indentfirst}
\usepackage{marvosym}
\usepackage{enumitem}
\usepackage[final]{pdfpages}
\usepackage[]{hyperref}
\usepackage{array}
\usepackage[ampersand]{easylist}
\usepackage[section] {placeins}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{bookmark}
 
\bookmarksetup
{
  numbered,
  open
}
\usepackage{tabularx,ragged2e}
\usepackage{color}
\usepackage[nodayofweek]{datetime}
\newdateformat{mydate}{\monthname[\THEMONTH] \THEYEAR}
\usepackage{titlesec}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\pagenumbering{arabic}
\renewcommand{\baselinestretch}{1.15}


\makeatletter
\renewcommand*{\thesection}{\arabic{section}}
\renewcommand\section{\leftskip 0pt\@startsection {section}{1}{\z@}%
                                   {-3.5ex \@plus -1ex \@minus -.2ex}%
                                   {2.3ex \@plus.2ex}%
                                   {\normalfont\Large\bfseries}}
\renewcommand\subsection{\leftskip 0pt\@startsection{subsection}{2}{\z@}%
                                     {-3.25ex\@plus -1ex \@minus -.2ex}%
                                     {1.5ex \@plus .2ex}%
                                     {\normalfont\large\bfseries\leftskip 4ex}}
\newcommand\Xsubsubsection{\@startsection{subsubsection}{3}{\z@}%
                                     {-3.25ex\@plus -1ex \@minus -.2ex}%
                                     {1.5ex \@plus .2ex}%
                                     {\normalfont\normalsize\bfseries\leftskip 8ex}}
\renewcommand\subsubsection[1]{\Xsubsubsection{#1}\leftskip 3ex}
\makeatother
\renewcommand{\baselinestretch}{1.15}
\renewcommand\tabularxcolumn[1]{>{\Centering}p{#1}}
\setlist[description]{leftmargin=\parindent,labelindent=\parindent}
\makeatletter
% Save the original \part declaration
\let\old@part\part

% To that definition, add a new special starred version.
\WithSuffix\def\part*{
  % Handle the optional parameter.
  \ifx\next[%
    \let\next\thesis@part@star%
  \else
    \def\next{\thesis@part@star[]}%
  \fi
  \next}

% The actual macro definition.
\def\thesis@part@star[#1]#2{
  \ifthenelse{\equal{#1}{}}
   {% If the first argument isn’t given, default to the second one.
    \def\thesis@part@short{#2}
    % Insert the actual (unnumbered) \part header.
    \old@part*{#2}}
   {% Short name is given.
    \def\thesis@part@short{#1}
    % Insert the actual (unnumbered) \part header with short name.
    \old@part*[#1]{#2}}

  % Last, add the part to the table of contents. Use the short name, if provided.
  \addcontentsline{toc}{part}{\thesis@part@short}
}
\makeatother

\newcommand*{\justifyheading}{\centering}
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries\justifyheading}{\chaptertitlename\ \thechapter}
  {20pt}{}  
  [
  \rule{8cm}{0.4pt}
  ]
\makeatletter
\@addtoreset{chapter}{part}
\makeatother 

\begin{document}
\begin{sloppypar}

\begin{titlepage}
\begin{center}
% Upper part of the page. The '~' is needed because \\
% only works if a paragraph has started.
\includegraphics[width=0.15\textwidth]{./img/logo.jpg}~\\[1.3cm]
\textsc{\LARGE Politechnika Poznañska}\\[4cm]
\textsc{\Large Projekt zaliczeniowy z Podstaw Techniki Mikroprocesorowej}\\[0.1cm]
% Title
\rule{10cm}{0.4pt}\\[0.4cm]
{ 
	\huge \bfseries AutoControl - Samochodowy minikomputer pok³adowy \\[0.35cm] 
	\small Z wykorzystaniem STM32 \\[0.4cm] 
}
\rule{10cm}{0.4pt} \\[3.5cm]
% Author and supervisor
\noindent
\begin{minipage}{0.4\textwidth}
\begin{flushleft} 
\large
\emph{Autorzy:}
\\ Damian Antczak
\\ Szymon K³êbowski 
\\ Micha³ Pietrzak 
\end{flushleft}
\end{minipage}%
\begin{minipage}{0.4\textwidth}
\begin{flushright} \large
\emph{Prowadz¹cy:} 
\\mgr~\textsc{Micha³ Nowicki} ~\\ ~\\ ~\\ ~\\ ~\\ ~\\ 
\end{flushright}
\end{minipage}
\vfill
% Bottom of the page
{\large Czerwiec 2015}
\end{center}
\end{titlepage}

\clearpage
\pagenumbering{arabic}
\tableofcontents

\clearpage
\vfill
\huge

	\addcontentsline{toc}{part}{Wstêp}
	\begin{center}
	    \textbf{\\Wstêp\\[1.3cm]}
	\end{center}
	\normalsize

	\paragraph{Link do filmiku prezentuj¹cego dzia³anie: }
		\underline{\href{https://youtu.be/0Yy9RWy4AZM}{Kliknij, ¿eby obejrzeæ}}
	\paragraph{Link do GitHub'a: }
		\underline{\href{https://github.com/MrSmooku/PTM-.git}{Kliknij, ¿eby otworzyæ w przegl¹darce}}
	\paragraph{Krótki wstêp\\ }
		Postanowiliœmy, ¿e nasz projekt bêdzie dotyczy³ zminimalizowanego i z ograniczon¹ liczb¹ funkcji minikomputera pok³adowego, który w przysz³oœci móg³by zostaæ zainstalowany w samochodzie. Przewidywana jest dalsza praca nad projektem w celu rozbudowania go o dodatkowe funkcje.
  
\clearpage
\vfill
\huge

	\addcontentsline{toc}{part}{Za³o¿enia projektu}
	\begin{center}
	    \textbf{\\Za³o¿enia projektu\\[1.3cm]}
	\end{center}
	\normalsize
	\paragraph{Funkcje}
	\begin{itemize}
	\item Wyœwietlanie czasu i daty
	\item Temperatura na zewn¹trz i wewn¹trz auta
	\item Informacja graficzna o otwartych drzwiach (lewe, prawe, baga¿nik)
	\item Obrotomierz stymulowany za pomoc¹ NE555
	\end{itemize}
	
	\paragraph{Podzespo³y planowane do u¿ycia}
	\begin{itemize}
	\item wyœwietlacz graficzny LGMFD12232G6YLY
	\item (lub) wyœwietlacz LCD Nokia 5110
	\item czujnik temperatury DS18B20
	\item czujnik temperatury i wilgotnoœci dht11
	\end{itemize}
	


\clearpage
\vfill
\huge

	\addcontentsline{toc}{part}{Dzia³anie uk³adu}
	\begin{center}
	    \textbf{\\Dzia³anie uk³adu\\[1.3cm]}
	\end{center}
	\normalsize
	\paragraph{Ustawienie RTC\\}
	Po w³¹czeniu uk³adu w pierwszej fazie u¿ytkownik ma mo¿liwoœæ ustawienie aktualnej godziny, póŸniej uk³ad przechodzi w stan w którym ustawia siê aktualn¹ datê.
	
	\paragraph{Normalna praca uk³adu\\}
	Po ustawieniu czasu i daty uk³ad przechodzi do normalnego stanu pracy, w stan ten zaliczaj¹ siê:
	-obrotomierz
	Na ekranie wyœwietla siê aktualna iloœæ obrotów silnika.
	-data i temperatura
	
	\paragraph{Zdarzenia specjalne\\}
	Normaln¹ pracê uk³adu przerywaj¹ zdarzenie, w projekcie wystêpuj¹ trzy takie zdarzenia: 
	-lewe drzwi otwarte,
	-prawe drzwi otwarte,
	-baga¿nik otwarty.
	W tych stanach na wyœwietlaczu pojawia siê informacja np. "Lewe drzwi otwarte" i ikonka otwarcia drzwi.
	
	\paragraph{Uproszczony graf wewnêtrznych stanów uk³adu:\\}	
	\includegraphics[width=1\textwidth]{./img/Graf.JPG}
	\\
	b – przycisk „User Button”\\
	t – czas\\
	p – przerwanie od drzwi lub baga¿nika\\
	\\
	\textbf{Stan 1:} Podczas trwania tego stanu na wyœwietlaczu wyœwietla siê animacja z nazw¹ projektu, po up³ywie
	pewnego czasu program przechodzi w kolejny stan.\\
	\textbf{Stan 2:} W tym stanie u¿ytkownik ustawia odpowiedni¹ godzinê i datê, przejœcia pomiêdzy ustawianiami
	powoduje u¿ytkownik przyciskiem „User Button”, a zmiany wartoœci konkretnych zmiennych
	przyciskiem „Change Button”.\\
	\textbf{Stan 3:} W stanie tym nastêpuj zapisanie do RTC ustawionych wartoœci dla czasu i daty, na wyœwietlaczu
	wyœwietla siê informacja: ;\\
	\textbf{Stan 4:} Na wyœwietlaczu pokazywane s¹ aktualna data i godzina, oraz temperatura i wilgotnoœæ;\\
	\textbf{Stan 5:} Informacja o aktualnej prêdkoœci obrotowej silnika w RPM oraz pasek w którym ka¿da 'pe³na'
	czcionka symbolizuje 1 000 RPM.
	Iloœæ obrotów mierzona jest przez uk³ad stm32 za pomoc¹ zliczania okresu pomiêdzy kolejnymi
	impulsami sygna³u prostok¹tnego. W przerwaniu zewnêtrznym nastêpuje uruchamianie timera,
	który liczy ten czas.
	\newpage
	
	Przerwanie zewnêtrzne:
	\begin{lstlisting}
	void EXTI1_IRQHandler(void) 
	{
		/* Make sure that interrupt flag is set */
		if (EXTI_GetITStatus(EXTI_Line1) != RESET) 
		{
			/* Do your stuff when PD0 is changed */
			if(nrZbocza==0)
			{
				TIM2->CNT = 0;
				TIM_Cmd(TIM2, ENABLE);
				nrZbocza=1;
			}
			else
			{
				czasImpulsu= TIM2->CNT;
				TIM_Cmd(TIM2, DISABLE);
				nrZbocza=0;
			}
			/* Clear interrupt flag */
			EXTI_ClearITPendingBit(EXTI_Line1);
		}
	}
	\end{lstlisting}
	
	
	\textbf{\\Stan 6:} Do stanu tego program wchodzi pod wp³ywem przerwañ generowanych przez zbocza narastaj¹ce na
	pinach …. . Piny te gdy s¹ podpiête w samochodzie do instalacji oœwietleniowej w kabinie i
	baga¿niku przez uk³ad z diod¹ zenera sygnalizuj¹ otwarcie drzwi b¹dŸ baga¿nika. Na wyœwietlaczu
	ukazuje siê informacja np.”Baga¿nik otwarty”. Przejœcie do tego stanu mo¿liwe jest jedynie ze
	stanu 4 lub 6.
	
	
\clearpage
%\addcontentsline{toc}{part}{Appendix I  \small{coding style}}
%\part*{Appendix I}
%\includepdf[pages=-]{CodingStyle.pdf}

\end{sloppypar}
\end{document}